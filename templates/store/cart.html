{% extends 'base.html' %}
{% load i18n %}
{% block title %}{% trans 'Carrito' %} - ArtesanÃ­as{% endblock %}
{% block extra_head %}
  <style>
    .cart-item { background:#fff; border: 1px solid #e5e5e5; padding: 15px; margin-bottom: 10px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.04); }
    .cart-item h3 { margin: 0 0 10px 0; color: #2c5aa0; }
    .cart-item p { margin: 5px 0; }
    .total-section { background-color: #fff; border:1px solid #e5e5e5; padding: 20px; border-radius: 10px; margin: 20px 0; box-shadow: 0 2px 6px rgba(0,0,0,0.04); }
    .btn { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; text-decoration: none; display: inline-block; }
    .btn-primary { background-color: #2c5aa0; color: white; }
    .btn-success { background-color: #28a745; color: white; }
    .btn-secondary { background-color: #6c757d; color: white; }
    .btn:hover { opacity: 0.95; }
    .empty-cart { text-align: center; padding: 40px; color: #666; }
  </style>
{% endblock %}
{% block content %}
  <h1>ğŸ›’ {% trans 'Tu Carrito de Compras' %}</h1>
  
  <!-- NavegaciÃ³n global en header -->
  
  {% if cart.items.all %}
    <div class="cart-items">
      {% for item in cart.items.all %}
        <div class="cart-item">
          <h3>{{ item.producto.nombre }}</h3>
          <p><strong>Precio unitario:</strong> ${{ item.producto.precio }}</p>
          <p><strong>Cantidad:</strong> {{ item.cantidad }}</p>
          <p><strong>Subtotal:</strong> ${{ item.subtotal }}</p>
          <form method="post" action="{% url 'remove_from_cart' item.id %}" style="margin-top: 10px;">
            {% csrf_token %}
            <button type="submit" class="btn btn-secondary">Eliminar</button>
          </form>
        </div>
      {% endfor %}
    </div>
    
    <div class="total-section">
      <h2>ğŸ’° {% trans 'Resumen del Pedido' %}</h2>
      <p><strong>{% trans 'Total de productos' %}:</strong> {{ cart.items.count }}</p>
      <p><strong>{% trans 'Total a pagar' %}:</strong> ${{ cart.total }}</p>
      
      <form action="{% url 'create_order' %}" method="post" style="margin-top: 20px;">
        {% csrf_token %}
        {% if request.GET.next %}
        <input type="hidden" name="next" value="{{ request.GET.next }}">
        {% endif %}
        <button type="submit" class="btn btn-success">ğŸ›’ {% trans 'Crear Orden' %}</button>
      </form>
    </div>
  {% else %}
    <div class="empty-cart">
      <h2>ğŸ›’ {% trans 'Tu carrito estÃ¡ vacÃ­o' %}</h2>
      <p>{% trans 'Â¡Agrega algunos productos de artesanÃ­as para comenzar tu compra!' %}</p>
    </div>
  {% endif %}
  
  <div style="margin-top: 20px;">
    {% if request.GET.next %}
      <a href="{{ request.GET.next }}" class="btn btn-secondary">â† {% trans 'Seguir comprando' %}</a>
    {% else %}
      <a href="{% url 'product_list' %}" class="btn btn-secondary">â† {% trans 'Seguir comprando' %}</a>
    {% endif %}
  </div>
{% endblock %}
